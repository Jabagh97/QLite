@using KioskApp.Helpers;
@using QLite.Data.CommonContext;
@using QLite.DesignComponents;
@using QLite.Data;
@using System.Text;
@model HomeAndDesPageDataViewModel
@inject IConfiguration Configuration

@{
    ViewData["Title"] = "Home Page";

    var currentTime = DateTime.Now.ToString("D");
}

@if (Model != null && Model.DesPageData != null && Model.DesPageData.Comps != null)
{

    <div id="canvas-container"
     style="
        width: @(Model.DesPageData.Width ?? "100vw");
        height: @(Model.DesPageData.Height ?? "100vh");
        background-image: url('@(Model.DesPageData.BgImageUrl ?? "")');
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
        border: 1px solid black;
            ">



        <div id="content"
         style="
        width: @(Model.DesPageData.Width ?? "100vw");
        height: @(Model.DesPageData.Height ?? "100vh");
         ">
            @foreach (var comp in Model.DesPageData.Comps)
            {
                @Html.Raw(RenderComponent(comp))
            }

        </div>

        @*Errors*@

        <div id="connectionError" class="alert alert-danger mb-4" style="display: none;" role="alert">


            @ViewHelper.GetLanguage("wsError")
        </div>

        <div id="AuthError" class="alert alert-danger mb-4" style="display: none;" role="alert">
            @ViewHelper.GetLanguage("authError")
        </div>


        <div id="Errors" style="display:none; font-family: Arial, sans-serif;">
            <div id="divooo" style="text-align:center;">
                <img src="~/media/ooo2.png" />
                <div style="margin-top: 20px;">
                    <div id="Printer" style="display: inline-block; margin-right: 20px;">
                        <img src="~/media/printerError.png" style="width: 100px; height: auto;" />
                        <span id="PrinterStatus" style="display: block; font-weight: bold; margin-top: 10px;font-size: large;">Printer is disconnected</span>
                    </div>
                    <div id="Display" style="display: inline-block; margin-right: 20px;">
                        <img src="~/media/displayError.png" style="width: 100px; height: auto;" />
                        <span id="DisplayStatus" style="display: block; font-weight: bold; margin-top: 10px;font-size: large;">Display is disconnected</span>
                    </div>
                    <div id="Terminal" style="display: inline-block;">
                        <img src="~/media/terminalError.png" style="width: 100px; height: auto;" />
                        <span id="TerminalStatus" style="display: block; font-weight: bold; margin-top: 10px;font-size: large;">Terminal is disconnected</span>
                    </div>
                </div>
            </div>
        </div>



    </div>

}
else
{
    <div class="container d-flex flex-column justify-content-center align-items-center h-100">
        <div id="connectionError" class="alert alert-danger mb-4" style="display: none;" role="alert">
            @ViewHelper.GetLanguage("wsError")
        </div>



        <div id="AuthError" class="alert alert-danger mb-4" style="display: none;" role="alert">
            @ViewHelper.GetLanguage("authError")
        </div>

        <div id="loadingAnimation" class="text-center mb-4" style="display: none;">
            <div class="spinner-border" role="status">
                <span class="sr-only">Loading...</span>
            </div>
            <p class="mt-2">Connecting to server...</p>
        </div>

        <div id="content" style="display: none;">
            <div class="text-center">
                <h1 class="display-4 mb-4" style="color:azure">
                    @ViewHelper.GetLanguage("Welcome")
                </h1>
                <div id="clock" style="font-size: calc(1vw + 1vh); color:azure">
                    @currentTime
                </div>
            </div>
            <div id="pv" class="form-group" style="text-align:center;color:azure">

                <div style="font-size: calc(2vw + 4vh); margin: 1%;">
                    @ViewHelper.GetLanguage("TouchToStart")
                </div>
            </div>
        </div>

        <div id="Errors" style="display:none; font-family: Arial, sans-serif;">
            <div id="divooo" style="text-align:center;">
                <img src="~/media/ooo2.png" style="width: calc(15vw + 15vh);" />
                <div style="margin-top: 20px;">
                    <div id="Printer" style="display: inline-block; margin-right: 20px;">
                        <img src="~/media/printerError.png" style="width: 100px; height: auto;" />
                        <span id="PrinterStatus" style="display: block; font-weight: bold; margin-top: 10px;font-size: large;">Printer is disconnected</span>
                    </div>
                    <div id="Display" style="display: inline-block; margin-right: 20px;">
                        <img src="~/media/displayError.png" style="width: 100px; height: auto;" />
                        <span id="DisplayStatus" style="display: block; font-weight: bold; margin-top: 10px;font-size: large;">Display is disconnected</span>
                    </div>
                    <div id="Terminal" style="display: inline-block;">
                        <img src="~/media/terminalError.png" style="width: 100px; height: auto;" />
                        <span id="TerminalStatus" style="display: block; font-weight: bold; margin-top: 10px;font-size: large;">Terminal is disconnected</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
}




@functions {
    public string RenderComponent(DesCompData comp)
    {
        switch (comp)
        {

            case DesCompDataGenericHtml htmlComp:
                return ViewHelper.RenderGenericHtmlComponent(htmlComp);
         


            default:
                return string.Empty; // Unknown component type
        }
    }
}
<script>
    var apiUrl = '@Configuration["APIBase"]';
    var kioskID = '@Configuration["KioskID"]';
</script>
