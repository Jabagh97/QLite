@model TicketAndDesPageDataViewModel

@*If a Custom Design is available*@

@if (Model != null && Model.DesPageData != null && Model.DesPageData.Comps != null)
{
    <div id="ticketdiv" class="ticket-container">
        <div id="ticket-body" class="ticket-body" data-width="@Model.DesPageData.Width" data-height="@Model.DesPageData.Height">
            @foreach (var comp in Model.DesPageData.Comps)
            {
                @Html.Raw(RenderComponent(comp, Model.Ticket))
            }
        </div>
    </div>
    <script src="~/js/ticketScaling.js"></script>

    @if (!Model.isMobile)
    {
        <script src="~/js/printTicketDesktop.js"></script>

    }
    else
    {
        <script src="~/js/htmlToImage.js"></script>

        <script src="~/js/saveTicketMobile.js"></script>

    }
}


else
{
    <div style="display: flex; justify-content: center; align-items: center;">

        <div id="ticketdiv" style="width:450px;height:750px;">
            <div id="ticket-body" class="card card-dashed" style="font-size: 2rem; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.4);">
                <div class="card-header">
                    <div class="d-flex justify-content-center align-items-center mb-3">
                        <img src="~/media/Qlite-mini.png" class="img-fluid" style="max-height: 40px; object-fit: contain;">
                    </div>
                    <h3 class="card-title"> @ViewHelper.GetLanguage("TicketInfo")</h3>

                </div>
                <div class="card-body">
                    <div class="font-weight-bold text-center mb-3">@Model?.Ticket.ServiceTypeName</div>
                    <div class="font-weight-bold text-center mb-3" style="font-size: 40px;"><b>@Model?.Ticket.ServiceCode @Model?.Ticket?.Number</b></div>
                    <div class="mb-3">
                        <table class="w-100">
                            <tr class="font-weight-bold">
                                <td class="text-left pl-2">@DateTime.Now.ToString("dd/MM/yyyy")</td>
                                <td class="text-right pr-2">@DateTime.Now.ToString("H:mm")</td>
                            </tr>
                        </table>
                    </div>
                </div>
                <div class="card-footer">
                    <div class="font-weight-bold text-center mb-3">
                        @ViewHelper.GetLanguage("numberOfWaiting") :@Model?.Ticket.WaitingTickets
                    </div>
                </div>
            </div>
        </div>
    </div>


     @if (!Model.isMobile)
    {
        <script src="~/js/printTicketDesktop.js"></script>

    }
    else
    {
        <script src="~/js/htmlToImage.js"></script>

        <script src="~/js/saveTicketMobile.js"></script>

    }


}


@functions {
    public string RenderComponent(DesCompData comp, Ticket ticket)
    {
        switch (comp)
        {
            case DesCompDataText textComp:
                return ViewHelper.RenderTicketComponent(textComp, ticket);

            case DesCompDataGenericHtml htmlComp:
                return ViewHelper.RenderGenericHtmlComponent(htmlComp);

            default:
                return string.Empty;
        }
    }


}


